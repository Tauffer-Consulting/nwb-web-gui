{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "metafile.schema.json",
  "title": "Metadata",
  "description": "Schema for the metadata",
  "version": "0.1.0",
  "type": "object",
  "required": ["NWBFile"],
  "additionalProperties": false,
  "properties": {

    "NWBFile": {
      "type": "object",
      "additionalProperties": false,
      "title": "pynwb.file.NWBFile",
      "required": ["sessiond-description", "identifier", "sessiond-startd-time"],
      "properties": {
        "sessiond-description": {
          "type": "string",
          "format": "long",
          "description": "a description of the session where this data was generated"
        },
        "identifier": {
          "type": "string",
          "description": "a unique text identifier for the file"
        },
        "sessiond-startd-time": {
          "type": "string",
          "description": "the start date and time of the recording session",
          "format": "date-time"
        },
        "experimenter": {
          "type": "array",
          "items": {"type": "string", "title": "experimenter"},
          "description": "name of person who performed experiment"
        },
        "experimentd-description": {
          "type": "string",
          "description": "general description of the experiment"
        },
        "sessiond-id": {
          "type": "string",
          "description": "lab-specific ID for the session"
        },
        "institution": {
          "type": "string",
          "description": "institution(s) where experiment is performed"
        },
        "notes": {
          "type": "string",
          "description": "Notes about the experiment."
        },
        "pharmacology": {
          "type": "string",
          "description": "Description of drugs used, including how and when they were administered. Anesthesia(s), painkiller(s), etc., plus dosage, concentration, etc."
        },
        "protocol": {
          "type": "string",
          "description": "Experimental protocol, if applicable. E.g., include IACUC protocol"
        },
        "relatedd-publications": {
          "type": "string",
          "description": "Publication information.PMID, DOI, URL, etc. If multiple, concatenate together and describe which is which. such as PMID, DOI, URL, etc"
        },
        "slices": {
          "type": "string",
          "description": "Description of slices, including information about preparation thickness, orientation, temperature and bath solution"
        },
        "sourced-script": {
          "type": "string",
          "description": "Script file used to create this NWB file."
        },
        "sourced-scriptd-filed-name": {
          "type": "string",
          "description": "Name of the sourced-script file"
        },
        "datad-collection": {
          "type": "string",
          "description": "Notes about data collection and analysis."
        },
        "surgery": {
          "type": "string",
          "description": "Narrative description about surgery/surgeries, including date(s) and who performed surgery."
        },
        "virus": {
          "type": "string",
          "description": "Information about virus(es) used in experiments, including virus ID, source, date made, injection location, volume, etc."
        },
        "stimulusd-notes": {
          "type": "string",
          "description": "Notes about stimuli, such as how and where presented."
        },
        "lab": {
          "type": "string",
          "description": "lab where experiment was performed"
        }
      }
    },

    "Subject": {
      "type": "object",
      "title": "pynwb.file.Subject",
      "required": ["subjectd-id"],
      "properties": {
        "subjectd-id": {
          "type": "string",
          "description": "ID of animal/person used/participating in experiment (lab convention)"
        },
        "description": {
          "type": "string",
          "description": "Description of subject and where subject came from (e.g., breeder, if animal)."
        },
        "genotype": {
          "type": "string",
          "description": "Genetic strain. If absent, assume Wild Type (WT)"
        },
        "sex": {
          "type": "string",
          "enum": ["M", "F", "U", "O"],
          "default": "U"
        },
        "species": {
          "type": "string",
          "description": "Species of subject. Use latin name."
        },
        "weight": {
          "type": "string",
          "description": "Weight at time of experiment, at time of surgery and at other important times."
        },
        "dated-ofd-birth": {
          "type": "string",
          "format": "date-time",
          "description": "Date of birth of subject. Can be supplied instead of age."
        }
      }
    },

    "Ecephys": {
      "type": "object",
      "title": "Ecephys",
      "required": [],
      "properties": {
        "Device1": {"$ref": "#/definitions/Device"},
        "Device2": {"$ref": "#/definitions/Device"},
        "ElectricalSeries1": {"$ref": "#/definitions/ElectricalSeries"},
        "ElectrodeGroup1": {
          "title": "pynwb.ecephys.ElectrodeGroup",
          "type": "object",
          "required": ["name", "description", "location", "device"],
          "properties": {
            "name": {
              "type": "string",
              "description": "the name of this electrode group"
            },
            "description": {
              "type": "string",
              "description": "description of this electrode group"
            },
            "location": {
              "type": "string",
              "description": "description of location of this electrode group"
            },
            "device": {
              "type": "string",
              "description": "the device that was used to record from this electrode group",
              "enum": []
            }
          }
        }
      }
    },

    "Ophys": {
      "type": "object",
      "title": "Ophys",
      "required": [],
      "properties": {
        "Device1": {"$ref": "#/definitions/Device"},
        "TwoPhotonSeries1": {"$ref": "#/definitions/TwoPhotonSeries"},
        "DFOverF1": {
          "type": "object",
          "title": "pynwb.ophys.DFOverF",
          "required": ["name"],
          "properties": {
            "name": {"type": "string"},
            "roid-responsed-series": {
              "type": "array",
              "items": [
                {"$ref":  "#/definitions/RoiResponseSeries"},
                {"$ref":  "#/definitions/RoiResponseSeries"}
              ]
            }
          }
        },
        "Fluorescence1": {
          "type": "object",
          "title": "pynwb.ophys.Fluorescence",
          "required": ["name"],
          "properties": {
            "name": {"type": "string"},
            "roid-responsed-series": {
              "type": "array",
              "items": [
                {"$ref":  "#/definitions/RoiResponseSeries"},
                {"$ref":  "#/definitions/RoiResponseSeries"}
              ]
            }
          }
        },
        "ImagingPlane": {
          "title": "pynwb.ophys.ImagingPlane",
          "type": "object",
          "required": ["name", "opticald-channel", "description", "device", "excitationd-lambda", "indicator", "location"],
          "properties": {
            "name": {
              "type": "string",
              "description": "the name of this container"
            },
            "description": {
              "type": "string",
              "description": "Description of this ImagingPlane"
            },
            "device": {
              "type": "string",
              "enum": []
            },
            "excitationd-lambda": {
              "type": "number",
              "description": "Excitation wavelength in nm"
            },
            "indicator": {
              "type": "string",
              "description": "Calcium indicator"
            },
            "location": {
              "type": "string",
              "description": "Location of image plane"
            },
            "imagingd-rate": {
              "type": "number",
              "description": "Rate images are acquired, in Hz. If the corresponding TimeSeries is present, the rate should be stored there instead"
            },
            "opticald-channels": {
              "type": "array",
              "items": [
                {"$ref":  "#/definitions/OpticalChannel"},
                {"$ref":  "#/definitions/OpticalChannel"}
              ]
            }
          }
        }
      }
    }

  },

  "definitions": {
    "Device": {
      "type": "object",
      "title": "pynwb.device.Device",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "the name of this device"
        },
        "description": {
          "type": "string",
          "description": " Description of the device (e.g., model, firmware version, processing software version, etc.)"
        },
        "manufacturer": {
          "type": "string",
          "description": "the name of the manufacturer of this device"
        }
      }
    },

    "TimeSeries": {
      "title": "pynwb.base.TimeSeries",
      "type": "object",
      "required": ["name", "description"],
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of this TimeSeries dataset"
        },
        "description": {
          "type": "string",
          "description": "Description of this TimeSeries dataset"
        },
        "unit":{
          "type": "string",
          "description": "The base unit of measurement (should be SI unit)"
        },
        "resolution": {
          "type": "number",
          "description": "The smallest meaningful difference (in specified unit) between values in data"
        },
        "conversion": {
          "type": "number",
          "description": "Scalar to multiply each element in data to convert it to the specified unit",
          "default": 1.0
        }
      }
    },

    "ElectricalSeries": {
      "title": "pynwb.ecephys.ElectricalSeries",
      "type": "object",
      "required": ["name", "description"],
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of this TimeSeries dataset"
        },
        "description": {
          "type": "string",
          "description": "Description of this TimeSeries dataset"
        },
        "unit":{
          "type": "string",
          "description": "The base unit of measurement (should be SI unit)"
        },
        "resolution": {
          "type": "number",
          "description": "The smallest meaningful difference (in specified unit) between values in data"
        },
        "conversion": {
          "type": "number",
          "description": "Scalar to multiply each element in data to convert it to the specified unit",
          "default": 1.0
        },
        "electrodes": {
          "type": "string",
          "description": "the table region corresponding to the electrodes from which this series was recorded"
        }
      }
    },

    "OpticalChannel": {
      "title": "pynwb.ophys.OpticalChannel",
      "type": "object",
      "required": ["name", "description", "emissiond-lambda"],
      "properties": {
        "name": {
          "type": "string",
          "description": "the name of this optical channel"
        },
        "description": {
          "type": "string",
          "description": "Any notes or comments about the channel"
        },
        "emissiond-lambda": {
          "type": "number",
          "description": "Emission wavelength for channel, in nm"
        }
      }
    },

    "RoiResponseSeries": {
      "title": "pynwb.ophys.RoiResponseSeries",
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of this TimeSeries dataset"
        },
        "description": {
          "type": "string",
          "description": "Description of this TimeSeries dataset"
        },
        "rois": {
          "type": "string",
          "description": "a table region corresponding to the ROIs that were used to generate this data"
        },
        "unit":{
          "type": "string",
          "description": "The base unit of measurement (should be SI unit)"
        },
        "resolution": {
          "type": "number",
          "description": "The smallest meaningful difference (in specified unit) between values in data"
        },
        "conversion": {
          "type": "number",
          "description": "Scalar to multiply each element in data to convert it to the specified unit",
          "default": 1.0
        }
      }
    },

    "TwoPhotonSeries": {
      "title": "pynwb.ophys.TwoPhotonSeries",
      "type": "object",
      "required": ["name", "description"],
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of this TimeSeries dataset"
        },
        "description": {
          "type": "string",
          "description": "Description of this TimeSeries dataset"
        },
        "imagingd-plane": {
          "type": "string",
          "description": "Imaging plane class/pointer",
          "enum": []
        },
        "unit":{
          "type": "string",
          "description": "The base unit of measurement (should be SI unit)"
        },
        "resolution": {
          "type": "number",
          "description": "The smallest meaningful difference (in specified unit) between values in data"
        },
        "conversion": {
          "type": "number",
          "description": "Scalar to multiply each element in data to convert it to the specified unit",
          "default": 1.0
        }
      }
    }

  }
}
